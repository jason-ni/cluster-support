# 快速开始

## 集群入门
![集群架构](img/cluster.png)

*图 集群拓扑结构图*

广义上来讲，一个高性能计算集群(High-Performance Computing Cluster)是由一组计算性能强劲的计算机通过高速网络连接后组成。集群中某单台计算机被称为节点（node）。高性能计算集群一般由登录节点、计算节点和存储节点组成。

其中，计算节点和存储节点不能被用户直接访问，需要用户先连接到登录节点，登录节点是连接整个集群的入口。计算节点，顾名思义，就是提供计算服务的计算机节点。通常情况下，一个用户作业任务需要一台或多台计算节点来支持其计算服务。将某个计算作业任务分配到不同计算节点上进行计算的工具被称为**作业调度器**。计算作业一般需要读写文件，我们采用了**共享存储系统**，将存储节点的磁盘空间映射到所有计算节点上。共享存储系统使用户可以像操作个人计算机上的文件一样操作远程的存储节点上的文件。

使用集群的一般步骤如下：

1. 选择所需要的编程语言或软件，了解该软件在集群上的加载和使用方法。准备源代码和数据。如需使用源代码编译执行的，使用相应编译工具进行编译。

2. 在调度系统中提交计算任务，任务将被调度执行。

3. 查看任务状态，等待任务执行完成，查看输出结果。

如果用户是个科学领域的新手，可以阅读我们提供的计算机[入门知识清单](intro.md)来熟悉计算机系统，或者阅读 [Introduction to High-Performance Computing][1] 和 [HPC in a day][2] 两个英文入门教程。

[1]: https://hpc-carpentry.github.io/hpc-intro/
[2]: https://psteinb.github.io/hpc-in-a-day/。

## 账号申请

集群现对人民大学在校师生开放，对于科研计算需求，请在[微人大][4]中填写相关信息进行申请。原则上，同一个导师的学生共享一个账户，这样方便同一课题组师生共享数据和软件，也方便我们进行管理。如有其它账号需求，请单独联系我们。

[4]: https://v.ruc.edu.cn/servcenter#/form/draw/8438

## 登录方法

用户需要基于SSH协议来访问集群，成功申请到账号后，请参考我们提供的[登录方法](cluster-login.md)。

## Linux

集群中所有节点均为CentOS 6 Linux操作系统，为用户提供了标准的64位Linux操作系统环境。这要求用户需具有一定的Linux操作基础，包括Linux shell命令行、vi编辑器操作基础等相关知识。这里推荐阅读[鸟哥的Linux私房菜 基础学习篇][3]来熟悉Linux。

[3]: http://cn.linux.vbird.org/linux_basic/linux_basic.php

## 软件使用

我们在集群上安装了常用的编译器、程序包和科学计算软件，涵盖了绝大多数科学计算应用场景，软件安装和使用说明请参考[软件使用文档](software.md)。如遇问题，可在本网站搜索框中搜索所需软件英文名，查找文档，如仍无法解决问题，可以联系我们。

## 提交作业

与用户的个人计算机不同，集群是一个多人共享的服务，不能直接在机器上执行计算任务，需要使用作业调度器来调度计算资源。我们采用了一款名为Torque的作业调度器来管理资源和调度作业。调度器会根据集群当时的负载状况，帮助用户分配所需要的计算资源，最终指定一台或多台计算节点来运行用户的计算任务。请参考[如何向集群提交作业](job-scheduler.md)。

## 文件管理

用户登录后将进入账户对应的家目录（home），对于某个用户，其家目录为`/home/your-cluster-username/`一般情况下，用户的个人数据都应存放在个人家目录中，包括安装的软件、代码、可执行文件和部分数据。家目录所的可用空间较小，较大的规模的数据或软件必须放置在 `/mnt/data/` 目录下，该目录可用容量为150TB。例如，用户需要创建自己的目录：

```bash
mkdir /mnt/data/your-cluster-name
```

然后将科研所需数据和软件拷贝到这个目录，拷贝时可以使用 `mv` 命令。

鉴于存储空间有限，出于数据安全的考虑，请用户务必及时备份和下载代码数据和计算结果，并定期清理存储空间。长时间不使用的用户和目录，我们将进行清理。

其他文件上传、下载、编辑的介绍，请参考[文件管理](file.md)。

!!! warning "注意！"
    对于长期不使用且占用较大存储资源的文件，我们可能会删除。如不需要使用该文件，请及时清理你自己的磁盘空间。

## 人大集群技术细节

中国人民大学高性能计算集群由55台计算节点、1台存储节点和1台登录节点组成，总CPU核数1456颗，内存共4608GB，存储空间190TB，理论计算峰值25625 GFLOPs。

集群操作系统为 CentOS 6，使用了NFS文件系统以支持用户的存储需求，使用了Torque/PBS作业调度系统支持集群计算资源调度。

由于校园网网关的限制以及安全的考虑，目前集群不支持从校外登陆。需要校外登录的用户可以考虑使用TeamViewer软件，在校外远程登录到校内机器上。

| 配置              	| 参数                                      	|
|-------------------	|-------------------------------------------	|
|    理论峰值性能   	|                 25625 GFLOPs                	|
|  linpack实测性能  	|                 21000 GFLOPs                	|
| 双路刀片节点 50台 	| 24 * Intel Xeon E5 2650 2.2G Hz / 64GB 内存 	|
|   四路胖节点 5台  	| 40 * Intel Xeon E5 4620 2.0G Hz / 256GB内存 	|
|      登录节点     	|                    1台                    	|
|      存储节点     	|                    1台                    	|
|      CPU核数      	|                   1456核                  	|
|        内存       	|                   4608GB                  	|
|      存储能力     	|                   150TB                   	|
|      操作系统     	|                 CentOS 6.6                	|
|      存储系统     	|                    NFS                    	|
|    作业调度系统   	|                PBS(Torque)                	|

表 1 集群配置概况

其中用户登录节点为IP地址为183.174.229.251。此节点为用户主登录节点，用户使用本集群需要先登录到此节点。用户在此节点上可以编译代码，并通过作业调度系统提交作业。

!!! warning "注意"
    禁止在登录节点上运行作业，否则会影响其他用户的使用！

| 类型 	| 节点名 	| 功能 	|
|--------	|------------	|----------------------------	|
| 登录节点 	| rmdx-cluster 	| 用户登录、编写代码、提交作业 	|
| 计算节点 	| node-0-1~16 	| 计算节点 	|
| - 	| node-1-1~16 	| - 	|
| - 	| node-2-1~16 	| - 	|
| - 	| node-3-1~2 	| - 	|
| - 	| pnode-1~5 	| 大内存、高性能计算 	|
| 存储节点 	| io-0-1 	| 文件存储 	|
